    :root{
      /* primary tunables - tweak these to change overall scaling */
      --bg:#F7F8FA; --card:#fff; --muted:#6b7280; --accent:#02008a;
      --sidebar-width:170px;
      --sidebar-collapsed-width:52px;
      --topbar-height:64px;

      /* bunker sizing (clamp will keep heights responsive) */
      --bunker-min-height:160px; --bunker-max-height:460px;
      --bunker-top-line-distance: 46px;
      --arrow-width: 3px;
      --bunker-arrow-height: 90px;
      --arrow-head-size: 12px;

      /* spacing */
      --app-gap:12px;
      --content-padding:12px;
    }

    /* --- Base layout: force app to exactly viewport height and remove page scroll --- */
    html, body {
      height:100%;
      margin:0;
      padding:0;
      width:100%;
      overflow-x:hidden;            /* no horizontal browser scroll */
      overflow-y:hidden;            /* remove vertical browser scroll */
      font-family:Inter, system-ui, Arial, sans-serif;
      background:var(--bg);
      color:#111;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* app fills viewport exactly; children must scale internally */
    .app {
      display:flex;
      height:100vh;                 /* lock to viewport */
      gap:var(--app-gap);
      box-sizing:border-box;
    }

    /* sidebar */
    .sidebar {
      width:var(--sidebar-width);
      background:#fff;
      border-right:1px solid rgba(0,0,0,0.04);
      padding:12px 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.03);
      display:flex;
      flex-direction:column;
      gap:6px;
      box-sizing:border-box;
      flex-shrink:0;
      min-width:var(--sidebar-collapsed-width);
      overflow-y:auto;
      max-height:100vh;
      transition:width 220ms ease;
    }
    .sidebar.collapsed { width:var(--sidebar-collapsed-width); }

    .sidebar .title { font-weight:800; color:var(--accent); padding:8px 10px; font-size:13px; }
    .sidebar .item {
      display:flex;
      align-items:center;
      padding:8px 10px;
      border-radius:8px;
      cursor:pointer;
      font-weight:700;
      color:#111;
      font-size:13px;
      gap:8px;
      white-space:nowrap;
    }
    .sidebar .item:hover { background:rgba(2,0,138,0.05); }
    .sidebar .item.active { background:var(--accent); color:#fff; box-shadow:0 6px 18px rgba(2,0,138,0.12); }
    .sidebar .s-icon { width:28px; height:28px; display:inline-flex; align-items:center; justify-content:center; background:rgba(2,0,138,0.06); border-radius:6px; font-weight:800; color:var(--accent); }
    .sidebar .s-label{ display:inline-block; }
    .sidebar.collapsed .s-label { display:none; }

    /* topbar fixed height */
    .topbar {
      height:var(--topbar-height);
      min-height:var(--topbar-height);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-bottom:0;
      flex-shrink:0;
    }
    .topbar .left{
      display:flex; align-items:center; gap:12px;
    }
    .topbar h1{ margin:0; font-size:16px; color:var(--accent); font-weight:800; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .controls{ display:flex; gap:8px; align-items:center; }
    .controls input{ padding:8px 10px; border-radius:8px; border:1px solid #e6e6e6; width:110px; font-size:14px; background:#fff; cursor:pointer; }

    /* hamburger */
    .hamburger{ width:42px; height:36px; display:inline-flex; align-items:center; justify-content:center; cursor:pointer; border-radius:8px; }
    .hamburger:hover{ background:rgba(0,0,0,0.03); }
    .hamburger .lines{ width:18px; height:14px; position:relative; }
    .hamburger .lines span{ position:absolute; left:0; right:0; height:2px; background:#222; border-radius:2px; }
    .hamburger .lines span:nth-child(1){ top:0; }
    .hamburger .lines span:nth-child(2){ top:6px; }
    .hamburger .lines span:nth-child(3){ top:12px; }

    /* layout card becomes a column flex so inner parts can shrink/flow */
    .layout-card{
      background:var(--card);
      border-radius:12px;
      padding:12px;
      box-shadow:0 10px 30px rgba(2,8,23,0.06);
      position:relative;
      overflow:visible;
      display:flex;
      flex-direction:column;
      gap:12px;
      height: calc(100% - var(--topbar-height) - 12px); /* fill remaining main area */
      box-sizing:border-box;
    }

    /* the main row is flexible and will wrap on small heights/widths */
    .layout-row{
      display:flex;
      gap:12px;
      align-items:flex-start;
      flex:1 1 auto;
      min-height:0; /* allow children to shrink */
      flex-wrap:wrap; /* wrap if width is constrained */
    }

    .diagram-column{
      flex:1 1 0;
      min-width:0;
      display:flex;
      flex-direction:column;
      gap:8px;
      min-height:0;
    }
    .stats-column{
      width:160px;
      flex-shrink:0;
      min-width:140px;
    }

    /* stats panel stays visible but will shrink its content */
    .stats-panel{
      width:100%;
      background:#02008a;
      color:#fff;
      padding:8px 10px;
      border-radius:8px;
      box-shadow:0 10px 22px rgba(2,8,23,0.10);
      display:flex;
      flex-direction:column;
      gap:6px;
      z-index:20;
      position:sticky;
      top: calc(var(--topbar-height) + 20px);
      font-size:13px;
    }
    .stat-row{ display:flex; justify-content:space-between; font-weight:700; }
    .stat-label{ opacity:0.95; font-weight:600; font-size:12px; color:rgba(255,255,255,0.95); }
    .stat-value{ font-weight:800; font-size:13px; }

    .diagram-inner { position:relative; padding:8px; min-height:0; display:flex; flex-direction:column; gap:8px; }

    .top-overlay { position: absolute; inset: 0 0 0 0; pointer-events: none; z-index: 90; }
    .top-line { position: absolute; top: var(--bunker-top-line-distance); left: 4%; right: 4%; height: 3px; background: #000; opacity:1; }

    .arrow { position: absolute; width: var(--arrow-width); background: #000; top: calc(var(--bunker-top-line-distance) + 4px); height: var(--bunker-arrow-height); transform-origin: top center; }
    .arrow::after { content: ''; position: absolute; left: calc(50% - 8px); top: 100%; width: 0; height: 0; border-left: 8px solid transparent; border-right: 8px solid transparent; border-top: var(--arrow-head-size) solid #000; }

    /* bunkers grid: allow wrapping so it never forces page size bigger than viewport */
    .bunkers-grid{
      display:flex;
      gap:18px;
      align-items:end;
      padding:18px;
      flex-wrap:wrap;          /* <-- important: wrap to new line if not enough width */
      box-sizing:border-box;
      justify-content:space-between;
      width:100%;
    }

    /* bunker heights will scale within clamp to prevent overflow */
    .bunker{
      position:relative;
      flex:1 1 11%;            /* allow shrink/grow; base width ~11% for 8 columns */
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:flex-end;
      min-width:120px;         /* prevents elements becoming too narrow */
      box-sizing:border-box;
      height: clamp(var(--bunker-min-height), 34vh, var(--bunker-max-height));
      max-height: calc(var(--bunker-max-height));
    }

    /* svg occupies available bunker height but is constrained */
    .bunker svg{ width:100%; height:100%; max-height:100%; display:block; object-fit:contain; }
    .bunker .label{ position:absolute; bottom:5px; left:50%; transform:translateX(-50%); background:rgba(255,255,255,0.98); padding:6px 10px; border-radius:8px; box-shadow:0 2px 10px rgba(0,0,0,0.06); font-weight:700; font-size:13px; white-space:nowrap; }

    /* single-bunker view reduced sizes to avoid overflow */
    .single-bunker-wrap { padding:12px; display:flex; justify-content:center; align-items:flex-start; }
    .single-bunker {
      width:100%;
      max-width:920px;
      height: clamp(240px, 66vh, 720px);
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:flex-end;
      position:relative;
    }
    .single-bunker svg{ width:60%; height:92%; max-height:640px; display:block; }
    .single-bunker .label{ position: absolute; bottom:-30px; left:50%; transform:translateX(-50%); background:rgba(255,255,255,0.98); padding:8px 12px; border-radius:10px; font-weight:800; font-size:16px; white-space:nowrap; }

    /* tooltip */
    .coal-tooltip {
      position: absolute;
      pointer-events: none;
      background: #fff;
      color: #111;
      border: 1px solid rgba(0,0,0,0.12);
      box-shadow: 0 6px 18px rgba(0,0,0,0.12);
      padding: 10px;
      border-radius: 8px;
      font-size: 13px;
      line-height:1.35;
      z-index: 2000;
      display: none;
      min-width: 160px;
    }

    /* ---------- Coal Flow boxes (UI only) ---------- */
    .coal-flow-wrap { margin-top:0; padding:0 0 8px; }
    .coal-flow-title { font-weight:800; margin:6px 18px 8px; color:var(--accent); font-size:14px; }
    .coal-flow-grid { display:flex; gap:12px; align-items:stretch; padding:0 18px; box-sizing:border-box; flex-wrap:wrap; }
    .coal-box {
      flex:1 1 11%;
      min-width:110px;
      height:46px;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      border-radius:10px;
      background:var(--card);
      box-shadow:0 8px 20px rgba(2,8,23,0.06);
      font-weight:800;
      font-size:13px;
      box-sizing:border-box;
    }
    .coal-box .value { font-size:15px; }
    .coal-box .label { font-size:12px; color:var(--muted); font-weight:700; margin-top:4px; }

    /* responsive: stack vertically on narrow screens and shrink heights */
    @media (max-width:1100px){
      .layout-row{ flex-direction:column; gap:10px; }
      .stats-column{ width:100%; order:2; }
      .sidebar{ display:none; } /* hide left sidebar on narrow screens to save space */
      .single-bunker svg{ width:80%; }
      .coal-flow-grid { gap:8px; padding:0 8px; }
      .coal-box { width:100%; flex-basis:auto; }
      .bunkers-grid { padding:8px; gap:10px; }
      .bunker { height: clamp(180px, 30vh, 380px); }
    }

    /* very short viewport (example: small laptop height) — make elements more compact */
    @media (max-height:720px){
      :root{
        --bunker-top-line-distance: 36px;
      }
      .bunker { height: clamp(160px, 36vh, 420px); }
      .coal-box { height:48px; }
      .topbar { height:56px; }
      .layout-card { padding:10px; }
    }

    /* ensure no element produces unintended browser scrollbar */
    * { box-sizing:border-box; }

    /* When in single-bunker mode we hide the stats-column and extra overview rows,
   and let the diagram column take the full width. */
.single-mode .stats-column {
  display: none !important;
}

.single-mode .diagram-column {
  flex: 1 1 100% !important;
  min-width: 0;
}

.single-mode .single-bunker svg {
  width: 90% !important;    /* make the single bunker svg wider */
  max-width: 1200px;
}

.single-mode #extraRowWrap,
.single-mode #extraRowGrid {
  display: none !important; /* extra row is hidden in single view just in case */
}

/* ----------------- add/replace these rules inside your <style> ----------------- */

/* topbar title replaced by requirement */
.topbar h1 {
  margin: 0;
  font-size: 16px;
  color: var(--accent);
  font-weight: 800;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* controls button styling (Refresh / Logout) */
.controls .btn {
  padding: 8px 12px;
  border-radius: 8px;
  border: 1px solid #e6e6e6;
  background: #fff;
  font-weight: 700;
  cursor: pointer;
  font-size: 14px;
}
.controls .btn:hover{ box-shadow: 0 6px 18px rgba(2,8,23,0.06); }

/* --- make single-bunker use full card width (no artificial max-width) --- */
.single-bunker {
  width: 100%;
  max-width: none;            /* allow full width inside the diagram-column */
  padding: 6px 0;
  display: flex;
  flex-direction: column;
  align-items: stretch;       /* stretch full width */
  justify-content: center;
}

/* svg should occupy the full area available in single view */
.single-bunker svg {
  width: 100% !important;
  height: calc(100% - 48px) !important; /* leave space for the label */
  max-height: none !important;
  display: block;
  object-fit: contain;
}

/* when in single-mode make svg wider if previously overridden */
.single-mode .single-bunker svg {
  width: 100% !important;
}

/* label adjusted to remain centered and not push layout */
.single-bunker .label {
  position: relative;
  bottom: 0;
  margin-top: 8px;
  left: 0;
  transform: none;
  text-align: center;
  display: block;
}

/* ensure layout-card still fits viewport without scrolling */
.layout-card {
  height: calc(100% - var(--topbar-height) - 12px);
  overflow: hidden; /* prevent internal overflow creating scrollbars */
}

/* keep body overflow hidden (already present) to avoid page scroll */
html, body {
  overflow-x: hidden;
  overflow-y: hidden;
}
.logout-btn{
  background: red;
  padding: 8px 12px;
  border-radius: 8px;
  border: 1px solid #e6e6e6;
  background: red;
  font-weight: 700;
  cursor: pointer;
  font-size: 14px;
  color: #F7F8FA;
}

/* ------------------ Make single view fill the diagram card but keep sidebar ------------------ */

/* Ensure the main layout keeps a flexible diagram column like overview */
.main, .content, .diagram-column {
  display: flex;
  flex-direction: column;
  flex: 1 1 auto;       /* take remaining space beside the sidebar */
  width: auto;
  max-width: none;
}

/* Make the container that holds the single view fill the diagram-column */
#singleView {
  display: block;
  width: 100%;
  max-width: none;
  margin: 0;           /* align with card edges */
  padding: 12px 18px;  /* breathing room inside the white card */
  box-sizing: border-box;
  background: transparent;
  box-shadow: none;
}

/* Single-bunker: expand to full available width inside the card */
.single-bunker {
  width: 100%;
  max-width: none;
  padding: 6px 0;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  align-items: stretch;   /* stretch the svg to full width */
  justify-content: center;
}

/* SVG should take full width of the single-bunker area and keep aspect ratio */
.single-bunker svg,
#singleSvg {
  width: 100% !important;
  height: auto !important; /* automatic height based on width and viewBox */
  max-height: calc(100vh - var(--topbar-height,64px) - 140px); /* keep it within viewport */
  display: block;
}

/* label below svg stays centered and doesn't affect svg size */
#singleLabel, .single-bunker .label {
  margin-top: 14px;
  text-align: center;
  font-weight: 800;
  font-size: 18px;
}

/* Make sure we do NOT hide or collapse the sidebar in single-mode:
   If you previously added rules hiding the sidebar, remove/comment them:
   e.g. remove/comment any rules like:
     body.single-mode .sidebar { display: none !important; width: 0 !important; }
   or
     .single-mode .diagram-column { width: 100% !important; }
*/

/* ----- Ensure stats panel stays visible and above diagram overlays ----- */
/* Put this near the end of your <style> inside input.html head */
.stats-panel {
  z-index: 999 !important;           /* keep it above top-overlay */
  position: sticky !important;       /* keep sticky behaviour */
  top: calc(var(--topbar-height) + 12px) !important;
}

/* Allow the layout-card to show sticky children (prevent clipping) */
.layout-card {
  overflow: visible !important;
}

/* Ensure stats-column is visible when not intentionally in single-mode */
.app:not(.single-mode) .stats-column {
  display: block !important;
}
/* ------------------ Keep stats panel at the right on desktop ------------------ */
/* Desktop: prevent layout-row wrapping so stats-column stays to the right */
@media (min-width: 1100px) {
  .layout-row {
    flex-wrap: nowrap;            /* prevent second-line wrapping */
    align-items: stretch;
    gap: 12px;
    min-height: 0;
  }

  /* Diagram column takes remaining space and can scroll internally if content is wide */
  .diagram-column {
    flex: 1 1 0;
    min-width: 0;                 /* allow it to shrink below content width */
    overflow: auto;               /* internal scroll if needed; won't push stats down */
    max-height: calc(100% - 0px);
  }

  /* Keep stats fixed width on the right (non-shrinking) */
  .stats-column {
    flex: 0 0 160px;              /* fixed width, won’t shrink below 160px */
    width: 160px;
    order: 2;                     /* ensure it's the right column */
  }

  /* Bunkers grid should live inside diagram-column and not force whole layout to grow */
  .bunkers-grid {
    box-sizing: border-box;
    flex: 1 1 auto;
    padding-right: 12px;          /* breathing room so right-most items don't hit stats */
    overflow:hidden;            /* internal wrapping of bunkers is still allowed */
  }
}

/* Preserve stacking behaviour on narrow screens (mobile/tablet) */
@media (max-width: 1099px) {
  .layout-row {
    flex-wrap: wrap;
  }
  .stats-column {
    width: 100%;
    order: 2;
    flex: 0 0 auto;
  }
  .diagram-column {
    width: 100%;
    order: 1;
    overflow: visible;
  }
}

/* ---------- Option B (scale-to-fit, no horizontal scroll) ---------- */
.bunkers-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(90px, 1fr));
  gap: 12px;
  align-items: end;
  width: 100%;
}

/* ensure we try to keep 8 columns on larger screens */
@media (min-width: 1300px) {
  .bunkers-grid { grid-template-columns: repeat(8, 1fr); }
}

/* arrow centered inside each bunker */
.bunker .arrow,
.bunker > .arrow {
  left: 50%;
  transform: translateX(-50%);
  position: absolute;
  top: calc(var(--bunker-top-line-distance) + 4px);
}

/* ===== blinking timer styles (paste into your existing <style>) ===== */
@keyframes blink-red-white {
  0%   { background-color: #ffffff; color: #0b0b0b; }
  50%  { background-color: #ff4d4d; color: #ffffff; }
  100% { background-color: #ffffff; color: #0b0b0b; }
}

/* apply animation to the small value node so only timer blinks */
.coal-box .value.blinking {
  animation: blink-red-white 1s linear infinite;
  padding: 2px 6px;          /* small padding so background looks neat */
  border-radius: 6px;
  display: inline-block;     /* keep layout stable */
  box-shadow: 0 4px 12px rgba(255,77,77,0.08);
}

/* optional: a 'done' state styling */
.coal-box .value.done {
  background: #0ea5a0;       /* teal-ish when done */
  color: #fff;
  padding: 2px 6px;
  border-radius: 6px;
  display: inline-block;
}

/* UNIT BUTTON STYLING (Compact Version) */
#unitSelector {
  display: flex;
  gap: 6px;
  padding: 6px;
  justify-content: center;
}

.unit-btn {
  background-color: #1f2937; /* dark gray */
  color: #fff;
  border: 1.5px solid transparent;
  border-radius: 6px;
  padding: 4px 10px;        /* smaller padding */
  font-size: 13px;          /* smaller text */
  font-weight: 500;
  cursor: pointer;
  transition: all 0.25s ease-in-out;
  box-shadow: 0 1px 3px rgba(0,0,0,0.15);
}

.unit-btn:hover {
  background-color: #374151; /* lighter gray */
  transform: translateY(-1px);
}

.unit-btn.active {
  background-color: #2563eb; /* blue highlight */
  border-color: #93c5fd;
  box-shadow: 0 0 6px rgba(37, 99, 235, 0.5);
  transform: translateY(-1px);
}


/* minimal core (but still paste full style from input.html for exact parity) */
/* html, body { height:100%; margin:0; padding:0; width:100%; overflow-x:hidden; overflow-y:hidden; font-family:Inter, system-ui, Arial, sans-serif; background:#F7F8FA; color:#111; }
.app { display:flex; height:100vh; gap:12px; box-sizing:border-box; }
.sidebar { width:170px; background:#fff; border-right:1px solid rgba(0,0,0,0.04); padding:12px 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.03); display:flex; flex-direction:column; gap:6px; }
.bunkers-grid { display:grid; grid-template-columns: repeat(4, 1fr); gap:10px; padding:12px; }
.bunker { background: #fff; border-radius: 10px; height: clamp(180px, 34vh, 420px); position:relative; display:flex; flex-direction:column; align-items:center; justify-content:center; box-shadow: 0 6px 20px rgba(2,8,23,0.06); }
.single-bunker svg, .bunker svg { width:100%; height:auto; display:block; }
.coal-tooltip { position: absolute; pointer-events: none; z-index: 9999; display:none; } */
